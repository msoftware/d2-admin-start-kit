{"remainingRequest":"C:\\Projekte\\vue-admin\\d2-admin-start-kit\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Projekte\\vue-admin\\d2-admin-start-kit\\src\\layout\\header-aside\\components\\tabs\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Projekte\\vue-admin\\d2-admin-start-kit\\src\\layout\\header-aside\\components\\tabs\\index.vue","mtime":1593435051124},{"path":"C:\\Projekte\\vue-admin\\d2-admin-start-kit\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1592891886067},{"path":"C:\\Projekte\\vue-admin\\d2-admin-start-kit\\node_modules\\babel-loader\\lib\\index.js","mtime":1592891886030},{"path":"C:\\Projekte\\vue-admin\\d2-admin-start-kit\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1592891886067},{"path":"C:\\Projekte\\vue-admin\\d2-admin-start-kit\\node_modules\\vue-loader\\lib\\index.js","mtime":1592891901729}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBtYXBTdGF0ZSwgbWFwQWN0aW9ucyB9IGZyb20gJ3Z1ZXgnDQppbXBvcnQgU29ydGFibGUgZnJvbSAnc29ydGFibGVqcycNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBjb21wb25lbnRzOiB7DQogICAgRDJDb250ZXh0bWVudTogKCkgPT4gaW1wb3J0KCcuLi9jb250ZXh0bWVudScpLA0KICAgIEQyQ29udGV4dG1lbnVMaXN0OiAoKSA9PiBpbXBvcnQoJy4uL2NvbnRleHRtZW51L2NvbXBvbmVudHMvY29udGVudG1lbnVMaXN0JykNCiAgfSwNCiAgZGF0YSAoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGNvbnRleHRtZW51RmxhZzogZmFsc2UsDQogICAgICBjb250ZW50bWVudVg6IDAsDQogICAgICBjb250ZW50bWVudVk6IDAsDQogICAgICBjb250ZXh0bWVudUxpc3RJbmRleDogWw0KICAgICAgICB7IGljb246ICd0aW1lcy1jaXJjbGUnLCB0aXRsZTogJ+WFs+mXreWFqOmDqCcsIHZhbHVlOiAnYWxsJyB9DQogICAgICBdLA0KICAgICAgY29udGV4dG1lbnVMaXN0OiBbDQogICAgICAgIHsgaWNvbjogJ2Fycm93LWxlZnQnLCB0aXRsZTogJ+WFs+mXreW3puS+pycsIHZhbHVlOiAnbGVmdCcgfSwNCiAgICAgICAgeyBpY29uOiAnYXJyb3ctcmlnaHQnLCB0aXRsZTogJ+WFs+mXreWPs+S+pycsIHZhbHVlOiAncmlnaHQnIH0sDQogICAgICAgIHsgaWNvbjogJ3RpbWVzJywgdGl0bGU6ICflhbPpl63lhbblroMnLCB2YWx1ZTogJ290aGVyJyB9LA0KICAgICAgICB7IGljb246ICd0aW1lcy1jaXJjbGUnLCB0aXRsZTogJ+WFs+mXreWFqOmDqCcsIHZhbHVlOiAnYWxsJyB9DQogICAgICBdLA0KICAgICAgdGFnTmFtZTogJy9pbmRleCcNCiAgICB9DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgLi4ubWFwU3RhdGUoJ2QyYWRtaW4vcGFnZScsIFsNCiAgICAgICdvcGVuZWQnLA0KICAgICAgJ2N1cnJlbnQnDQogICAgXSkNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIC4uLm1hcEFjdGlvbnMoJ2QyYWRtaW4vcGFnZScsIFsNCiAgICAgICdjbG9zZScsDQogICAgICAnY2xvc2VMZWZ0JywNCiAgICAgICdjbG9zZVJpZ2h0JywNCiAgICAgICdjbG9zZU90aGVyJywNCiAgICAgICdjbG9zZUFsbCcsDQogICAgICAnb3BlbmVkU29ydCcNCiAgICBdKSwNCiAgICAvKioNCiAgICAgKiBAZGVzY3JpcHRpb24g6K6h566X5p+Q5Liq5qCH562+6aG15piv5ZCm5Y+v5YWz6ZetDQogICAgICogQHBhcmFtIHtPYmplY3R9IHBhZ2Ug5YW25Lit5LiA5Liq5qCH562+6aG1DQogICAgICovDQogICAgaXNUYWJDbG9zYWJsZSAocGFnZSkgew0KICAgICAgcmV0dXJuIHBhZ2UubmFtZSAhPT0gJ2luZGV4Jw0KICAgIH0sDQogICAgLyoqDQogICAgICogQGRlc2NyaXB0aW9uIOWPs+mUruiPnOWNleWKn+iDveeCueWHuw0KICAgICAqIEBwYXJhbSB7T2JqZWN0fSBldmVudCDkuovku7YNCiAgICAgKi8NCiAgICBoYW5kbGVDb250ZXh0bWVudSAoZXZlbnQpIHsNCiAgICAgIGxldCB0YXJnZXQgPSBldmVudC50YXJnZXQNCiAgICAgIC8vIGZpeCBodHRwczovL2dpdGh1Yi5jb20vZDItcHJvamVjdHMvZDItYWRtaW4vaXNzdWVzLzU0DQogICAgICBsZXQgZmxhZyA9IGZhbHNlDQogICAgICBpZiAodGFyZ2V0LmNsYXNzTmFtZS5pbmRleE9mKCdlbC10YWJzX19pdGVtJykgPiAtMSkgZmxhZyA9IHRydWUNCiAgICAgIGVsc2UgaWYgKHRhcmdldC5wYXJlbnROb2RlLmNsYXNzTmFtZS5pbmRleE9mKCdlbC10YWJzX19pdGVtJykgPiAtMSkgew0KICAgICAgICB0YXJnZXQgPSB0YXJnZXQucGFyZW50Tm9kZQ0KICAgICAgICBmbGFnID0gdHJ1ZQ0KICAgICAgfQ0KICAgICAgaWYgKGZsYWcpIHsNCiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKQ0KICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKQ0KICAgICAgICB0aGlzLmNvbnRlbnRtZW51WCA9IGV2ZW50LmNsaWVudFgNCiAgICAgICAgdGhpcy5jb250ZW50bWVudVkgPSBldmVudC5jbGllbnRZDQogICAgICAgIHRoaXMudGFnTmFtZSA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnKS5zbGljZSg1KQ0KICAgICAgICB0aGlzLmNvbnRleHRtZW51RmxhZyA9IHRydWUNCiAgICAgIH0NCiAgICB9LA0KICAgIC8qKg0KICAgICAqIEBkZXNjcmlwdGlvbiDlj7PplK7oj5zljZXnmoQgcm93LWNsaWNrIOS6i+S7tg0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjb21tYW5kIOS6i+S7tuexu+Weiw0KICAgICAqLw0KICAgIGNvbnRleHRtZW51Q2xpY2sgKGNvbW1hbmQpIHsNCiAgICAgIHRoaXMuaGFuZGxlQ29udHJvbEl0ZW1DbGljayhjb21tYW5kLCB0aGlzLnRhZ05hbWUpDQogICAgfSwNCiAgICAvKioNCiAgICAgKiBAZGVzY3JpcHRpb24g5o6l5pS254K55Ye75YWz6Zet5o6n5Yi25LiK6YCJ6aG555qE5LqL5Lu2DQogICAgICogQHBhcmFtIHtTdHJpbmd9IGNvbW1hbmQg5LqL5Lu257G75Z6LDQogICAgICogQHBhcmFtIHtTdHJpbmd9IHRhZ05hbWUgdGFiIOWQjeensA0KICAgICAqLw0KICAgIGhhbmRsZUNvbnRyb2xJdGVtQ2xpY2sgKGNvbW1hbmQsIHRhZ05hbWUgPSBudWxsKSB7DQogICAgICBpZiAodGFnTmFtZSkgdGhpcy5jb250ZXh0bWVudUZsYWcgPSBmYWxzZQ0KICAgICAgY29uc3QgcGFyYW1zID0geyBwYWdlU2VsZWN0OiB0YWdOYW1lIH0NCiAgICAgIHN3aXRjaCAoY29tbWFuZCkgew0KICAgICAgICBjYXNlICdsZWZ0JzogdGhpcy5jbG9zZUxlZnQocGFyYW1zKTsgYnJlYWsNCiAgICAgICAgY2FzZSAncmlnaHQnOiB0aGlzLmNsb3NlUmlnaHQocGFyYW1zKTsgYnJlYWsNCiAgICAgICAgY2FzZSAnb3RoZXInOiB0aGlzLmNsb3NlT3RoZXIocGFyYW1zKTsgYnJlYWsNCiAgICAgICAgY2FzZSAnYWxsJzogdGhpcy5jbG9zZUFsbCgpOyBicmVhaw0KICAgICAgICBkZWZhdWx0OiB0aGlzLiRtZXNzYWdlLmVycm9yKCfml6DmlYjnmoTmk43kvZwnKTsgYnJlYWsNCiAgICAgIH0NCiAgICB9LA0KICAgIC8qKg0KICAgICAqIEBkZXNjcmlwdGlvbiDmjqXmlLbngrnlh7sgdGFiIOagh+etvueahOS6i+S7tg0KICAgICAqIEBwYXJhbSB7b2JqZWN0fSB0YWIg5qCH562+DQogICAgICogQHBhcmFtIHtvYmplY3R9IGV2ZW50IOS6i+S7tg0KICAgICAqLw0KICAgIGhhbmRsZUNsaWNrICh0YWIsIGV2ZW50KSB7DQogICAgICAvLyDmib7liLDngrnlh7vnmoTpobXpnaLlnKggdGFnIOWIl+ihqOmHjOaYr+WTquS4qg0KICAgICAgY29uc3QgcGFnZSA9IHRoaXMub3BlbmVkLmZpbmQocGFnZSA9PiBwYWdlLmZ1bGxQYXRoID09PSB0YWIubmFtZSkNCiAgICAgIGlmIChwYWdlKSB7DQogICAgICAgIGNvbnN0IHsgbmFtZSwgcGFyYW1zLCBxdWVyeSB9ID0gcGFnZQ0KICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWUsIHBhcmFtcywgcXVlcnkgfSkNCiAgICAgIH0NCiAgICB9LA0KICAgIC8qKg0KICAgICAqIEBkZXNjcmlwdGlvbiDngrnlh7sgdGFiIOS4iueahOWIoOmZpOaMiemSruinpuWPkei/memHjA0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSB0YWdOYW1lIHRhYiDlkI3np7ANCiAgICAgKi8NCiAgICBoYW5kbGVUYWJSZW1vdmUgKHRhZ05hbWUpIHsNCiAgICAgIHRoaXMuY2xvc2UoeyB0YWdOYW1lIH0pDQogICAgfQ0KICB9LA0KICBtb3VudGVkICgpIHsNCiAgICBjb25zdCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kMi1tdWx0aXBsZS1wYWdlLXNvcnQgLmVsLXRhYnNfX25hdicpWzBdDQogICAgU29ydGFibGUuY3JlYXRlKGVsLCB7DQogICAgICBvbkVuZDogKGV2dCkgPT4gew0KICAgICAgICBjb25zdCB7IG9sZEluZGV4LCBuZXdJbmRleCB9ID0gZXZ0DQogICAgICAgIHRoaXMub3BlbmVkU29ydCh7IG9sZEluZGV4LCBuZXdJbmRleCB9KQ0KICAgICAgfQ0KICAgIH0pDQogIH0NCn0NCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2DA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/layout/header-aside/components/tabs","sourcesContent":["<template>\r\n  <div class=\"d2-multiple-page-control-group\" flex>\r\n    <div class=\"d2-multiple-page-control-content\" flex-box=\"1\">\r\n      <div class=\"d2-multiple-page-control-content-inner\">\r\n        <d2-contextmenu\r\n          :visible.sync=\"contextmenuFlag\"\r\n          :x=\"contentmenuX\"\r\n          :y=\"contentmenuY\">\r\n          <d2-contextmenu-list\r\n            :menulist=\"tagName === '/index' ? contextmenuListIndex : contextmenuList\"\r\n            @rowClick=\"contextmenuClick\"/>\r\n        </d2-contextmenu>\r\n        <el-tabs\r\n          class=\"d2-multiple-page-control d2-multiple-page-sort\"\r\n          :value=\"current\"\r\n          type=\"card\"\r\n          @tab-click=\"handleClick\"\r\n          @tab-remove=\"handleTabRemove\"\r\n          @contextmenu.native=\"handleContextmenu\">\r\n          <el-tab-pane\r\n            v-for=\"page in opened\"\r\n            :key=\"page.fullPath\"\r\n            :label=\"page.meta.title || '未命名'\"\r\n            :name=\"page.fullPath\"\r\n            :closable=\"isTabClosable(page)\"/>\r\n        </el-tabs>\r\n      </div>\r\n    </div>\r\n    <div class=\"d2-multiple-page-control-btn\" flex-box=\"0\">\r\n      <el-dropdown\r\n        size=\"default\"\r\n        split-button\r\n        @click=\"closeAll\"\r\n        @command=\"command => handleControlItemClick(command)\">\r\n        <d2-icon name=\"times-circle\"/>\r\n        <el-dropdown-menu slot=\"dropdown\">\r\n          <el-dropdown-item command=\"left\">\r\n            <d2-icon name=\"arrow-left\" class=\"d2-mr-10\"/>\r\n            关闭左侧\r\n          </el-dropdown-item>\r\n          <el-dropdown-item command=\"right\">\r\n            <d2-icon name=\"arrow-right\" class=\"d2-mr-10\"/>\r\n            关闭右侧\r\n          </el-dropdown-item>\r\n          <el-dropdown-item command=\"other\">\r\n            <d2-icon name=\"times\" class=\"d2-mr-10\"/>\r\n            关闭其它\r\n          </el-dropdown-item>\r\n          <el-dropdown-item command=\"all\">\r\n            <d2-icon name=\"times-circle\" class=\"d2-mr-10\"/>\r\n            全部关闭\r\n          </el-dropdown-item>\r\n        </el-dropdown-menu>\r\n      </el-dropdown>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapActions } from 'vuex'\r\nimport Sortable from 'sortablejs'\r\n\r\nexport default {\r\n  components: {\r\n    D2Contextmenu: () => import('../contextmenu'),\r\n    D2ContextmenuList: () => import('../contextmenu/components/contentmenuList')\r\n  },\r\n  data () {\r\n    return {\r\n      contextmenuFlag: false,\r\n      contentmenuX: 0,\r\n      contentmenuY: 0,\r\n      contextmenuListIndex: [\r\n        { icon: 'times-circle', title: '关闭全部', value: 'all' }\r\n      ],\r\n      contextmenuList: [\r\n        { icon: 'arrow-left', title: '关闭左侧', value: 'left' },\r\n        { icon: 'arrow-right', title: '关闭右侧', value: 'right' },\r\n        { icon: 'times', title: '关闭其它', value: 'other' },\r\n        { icon: 'times-circle', title: '关闭全部', value: 'all' }\r\n      ],\r\n      tagName: '/index'\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState('d2admin/page', [\r\n      'opened',\r\n      'current'\r\n    ])\r\n  },\r\n  methods: {\r\n    ...mapActions('d2admin/page', [\r\n      'close',\r\n      'closeLeft',\r\n      'closeRight',\r\n      'closeOther',\r\n      'closeAll',\r\n      'openedSort'\r\n    ]),\r\n    /**\r\n     * @description 计算某个标签页是否可关闭\r\n     * @param {Object} page 其中一个标签页\r\n     */\r\n    isTabClosable (page) {\r\n      return page.name !== 'index'\r\n    },\r\n    /**\r\n     * @description 右键菜单功能点击\r\n     * @param {Object} event 事件\r\n     */\r\n    handleContextmenu (event) {\r\n      let target = event.target\r\n      // fix https://github.com/d2-projects/d2-admin/issues/54\r\n      let flag = false\r\n      if (target.className.indexOf('el-tabs__item') > -1) flag = true\r\n      else if (target.parentNode.className.indexOf('el-tabs__item') > -1) {\r\n        target = target.parentNode\r\n        flag = true\r\n      }\r\n      if (flag) {\r\n        event.preventDefault()\r\n        event.stopPropagation()\r\n        this.contentmenuX = event.clientX\r\n        this.contentmenuY = event.clientY\r\n        this.tagName = target.getAttribute('aria-controls').slice(5)\r\n        this.contextmenuFlag = true\r\n      }\r\n    },\r\n    /**\r\n     * @description 右键菜单的 row-click 事件\r\n     * @param {String} command 事件类型\r\n     */\r\n    contextmenuClick (command) {\r\n      this.handleControlItemClick(command, this.tagName)\r\n    },\r\n    /**\r\n     * @description 接收点击关闭控制上选项的事件\r\n     * @param {String} command 事件类型\r\n     * @param {String} tagName tab 名称\r\n     */\r\n    handleControlItemClick (command, tagName = null) {\r\n      if (tagName) this.contextmenuFlag = false\r\n      const params = { pageSelect: tagName }\r\n      switch (command) {\r\n        case 'left': this.closeLeft(params); break\r\n        case 'right': this.closeRight(params); break\r\n        case 'other': this.closeOther(params); break\r\n        case 'all': this.closeAll(); break\r\n        default: this.$message.error('无效的操作'); break\r\n      }\r\n    },\r\n    /**\r\n     * @description 接收点击 tab 标签的事件\r\n     * @param {object} tab 标签\r\n     * @param {object} event 事件\r\n     */\r\n    handleClick (tab, event) {\r\n      // 找到点击的页面在 tag 列表里是哪个\r\n      const page = this.opened.find(page => page.fullPath === tab.name)\r\n      if (page) {\r\n        const { name, params, query } = page\r\n        this.$router.push({ name, params, query })\r\n      }\r\n    },\r\n    /**\r\n     * @description 点击 tab 上的删除按钮触发这里\r\n     * @param {String} tagName tab 名称\r\n     */\r\n    handleTabRemove (tagName) {\r\n      this.close({ tagName })\r\n    }\r\n  },\r\n  mounted () {\r\n    const el = document.querySelectorAll('.d2-multiple-page-sort .el-tabs__nav')[0]\r\n    Sortable.create(el, {\r\n      onEnd: (evt) => {\r\n        const { oldIndex, newIndex } = evt\r\n        this.openedSort({ oldIndex, newIndex })\r\n      }\r\n    })\r\n  }\r\n}\r\n</script>\r\n"]}]}