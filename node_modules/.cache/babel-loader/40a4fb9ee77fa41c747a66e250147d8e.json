{"remainingRequest":"C:\\Projekte\\vue-admin\\d2-admin-start-kit\\node_modules\\babel-loader\\lib\\index.js!C:\\Projekte\\vue-admin\\d2-admin-start-kit\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Projekte\\vue-admin\\d2-admin-start-kit\\src\\libs\\util.db.js","dependencies":[{"path":"C:\\Projekte\\vue-admin\\d2-admin-start-kit\\src\\libs\\util.db.js","mtime":1593434353512},{"path":"C:\\Projekte\\vue-admin\\d2-admin-start-kit\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Projekte\\vue-admin\\d2-admin-start-kit\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Projekte\\vue-admin\\d2-admin-start-kit\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0IGxvdyBmcm9tICdsb3dkYic7CmltcG9ydCBMb2NhbFN0b3JhZ2UgZnJvbSAnbG93ZGIvYWRhcHRlcnMvTG9jYWxTdG9yYWdlJzsKaW1wb3J0IHV0aWwgZnJvbSAnQC9saWJzL3V0aWwnOwppbXBvcnQgeyBjbG9uZURlZXAgfSBmcm9tICdsb2Rhc2gnOwp2YXIgYWRhcHRlciA9IG5ldyBMb2NhbFN0b3JhZ2UoImQyYWRtaW4tIi5jb25jYXQocHJvY2Vzcy5lbnYuVlVFX0FQUF9WRVJTSU9OKSk7CnZhciBkYiA9IGxvdyhhZGFwdGVyKTsKZGIuZGVmYXVsdHMoewogIHN5czoge30sCiAgZGF0YWJhc2U6IHt9Cn0pLndyaXRlKCk7CmV4cG9ydCBkZWZhdWx0IGRiOwovKioNCiAqIEBkZXNjcmlwdGlvbiDmo4Dmn6Xot6/lvoTmmK/lkKblrZjlnKgg5LiN5a2Y5Zyo55qE6K+d5Yid5aeL5YyWDQogKiBAcGFyYW0ge09iamVjdH0gcGF5bG9hZCBkYk5hbWUge1N0cmluZ30g5pWw5o2u5bqT5ZCN56ewDQogKiBAcGFyYW0ge09iamVjdH0gcGF5bG9hZCBwYXRoIHtTdHJpbmd9IOi3r+W+hA0KICogQHBhcmFtIHtPYmplY3R9IHBheWxvYWQgdXNlciB7Qm9vbGVhbn0g5Yy65YiG55So5oi3DQogKiBAcGFyYW0ge09iamVjdH0gcGF5bG9hZCB2YWxpZGF0b3Ige0Z1bmN0aW9ufSDmlbDmja7moKHpqozpkqnlrZAg6L+U5ZueIHRydWUg6KGo56S66aqM6K+B6YCa6L+HDQogKiBAcGFyYW0ge09iamVjdH0gcGF5bG9hZCBkZWZhdWx0VmFsdWUgeyp9IOWIneWni+WMlum7mOiupOWAvA0KICogQHJldHVybnMge1N0cmluZ30g5Y+v5Lul55u05o6l5L2/55So55qE6Lev5b6EDQogKi8KCmV4cG9ydCBmdW5jdGlvbiBwYXRoSW5pdChfcmVmKSB7CiAgdmFyIF9yZWYkZGJOYW1lID0gX3JlZi5kYk5hbWUsCiAgICAgIGRiTmFtZSA9IF9yZWYkZGJOYW1lID09PSB2b2lkIDAgPyAnZGF0YWJhc2UnIDogX3JlZiRkYk5hbWUsCiAgICAgIF9yZWYkcGF0aCA9IF9yZWYucGF0aCwKICAgICAgcGF0aCA9IF9yZWYkcGF0aCA9PT0gdm9pZCAwID8gJycgOiBfcmVmJHBhdGgsCiAgICAgIF9yZWYkdXNlciA9IF9yZWYudXNlciwKICAgICAgdXNlciA9IF9yZWYkdXNlciA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9yZWYkdXNlciwKICAgICAgX3JlZiR2YWxpZGF0b3IgPSBfcmVmLnZhbGlkYXRvciwKICAgICAgdmFsaWRhdG9yID0gX3JlZiR2YWxpZGF0b3IgPT09IHZvaWQgMCA/IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0cnVlOwogIH0gOiBfcmVmJHZhbGlkYXRvciwKICAgICAgX3JlZiRkZWZhdWx0VmFsdWUgPSBfcmVmLmRlZmF1bHRWYWx1ZSwKICAgICAgZGVmYXVsdFZhbHVlID0gX3JlZiRkZWZhdWx0VmFsdWUgPT09IHZvaWQgMCA/ICcnIDogX3JlZiRkZWZhdWx0VmFsdWU7CiAgdmFyIHV1aWQgPSB1dGlsLmNvb2tpZXMuZ2V0KCd1dWlkJykgfHwgJ2dob3N0LXV1aWQnOwogIHZhciBjdXJyZW50UGF0aCA9ICIiLmNvbmNhdChkYk5hbWUsICIuIikuY29uY2F0KHVzZXIgPyAidXNlci4iLmNvbmNhdCh1dWlkKSA6ICdwdWJsaWMnKS5jb25jYXQocGF0aCA/ICIuIi5jb25jYXQocGF0aCkgOiAnJyk7CiAgdmFyIHZhbHVlID0gZGIuZ2V0KGN1cnJlbnRQYXRoKS52YWx1ZSgpOwoKICBpZiAoISh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbGlkYXRvcih2YWx1ZSkpKSB7CiAgICBkYi5zZXQoY3VycmVudFBhdGgsIGRlZmF1bHRWYWx1ZSkud3JpdGUoKTsKICB9CgogIHJldHVybiBjdXJyZW50UGF0aDsKfQovKioNCiAqIEBkZXNjcmlwdGlvbiDlsIbmlbDmja7lrZjlgqjliLDmjIflrprkvY3nva4gfCDot6/lvoTkuI3lrZjlnKjkvJroh6rliqjliJ3lp4vljJYNCiAqIEBkZXNjcmlwdGlvbiDmlYjmnpznsbvkvLzkuo7lj5blgLwgZGJOYW1lLnBhdGggPSB2YWx1ZQ0KICogQHBhcmFtIHtPYmplY3R9IHBheWxvYWQgZGJOYW1lIHtTdHJpbmd9IOaVsOaNruW6k+WQjeensA0KICogQHBhcmFtIHtPYmplY3R9IHBheWxvYWQgcGF0aCB7U3RyaW5nfSDlrZjlgqjot6/lvoQNCiAqIEBwYXJhbSB7T2JqZWN0fSBwYXlsb2FkIHZhbHVlIHsqfSDpnIDopoHlrZjlgqjnmoTlgLwNCiAqIEBwYXJhbSB7T2JqZWN0fSBwYXlsb2FkIHVzZXIge0Jvb2xlYW59IOaYr+WQpuWMuuWIhueUqOaItw0KICovCgpleHBvcnQgZnVuY3Rpb24gZGJTZXQoX3JlZjIpIHsKICB2YXIgX3JlZjIkZGJOYW1lID0gX3JlZjIuZGJOYW1lLAogICAgICBkYk5hbWUgPSBfcmVmMiRkYk5hbWUgPT09IHZvaWQgMCA/ICdkYXRhYmFzZScgOiBfcmVmMiRkYk5hbWUsCiAgICAgIF9yZWYyJHBhdGggPSBfcmVmMi5wYXRoLAogICAgICBwYXRoID0gX3JlZjIkcGF0aCA9PT0gdm9pZCAwID8gJycgOiBfcmVmMiRwYXRoLAogICAgICBfcmVmMiR2YWx1ZSA9IF9yZWYyLnZhbHVlLAogICAgICB2YWx1ZSA9IF9yZWYyJHZhbHVlID09PSB2b2lkIDAgPyAnJyA6IF9yZWYyJHZhbHVlLAogICAgICBfcmVmMiR1c2VyID0gX3JlZjIudXNlciwKICAgICAgdXNlciA9IF9yZWYyJHVzZXIgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjIkdXNlcjsKICBkYi5zZXQocGF0aEluaXQoewogICAgZGJOYW1lOiBkYk5hbWUsCiAgICBwYXRoOiBwYXRoLAogICAgdXNlcjogdXNlcgogIH0pLCB2YWx1ZSkud3JpdGUoKTsKfQovKioNCiAqIEBkZXNjcmlwdGlvbiDojrflj5bmlbDmja4NCiAqIEBkZXNjcmlwdGlvbiDmlYjmnpznsbvkvLzkuo7lj5blgLwgZGJOYW1lLnBhdGggfHwgZGVmYXVsdFZhbHVlDQogKiBAcGFyYW0ge09iamVjdH0gcGF5bG9hZCBkYk5hbWUge1N0cmluZ30g5pWw5o2u5bqT5ZCN56ewDQogKiBAcGFyYW0ge09iamVjdH0gcGF5bG9hZCBwYXRoIHtTdHJpbmd9IOWtmOWCqOi3r+W+hA0KICogQHBhcmFtIHtPYmplY3R9IHBheWxvYWQgZGVmYXVsdFZhbHVlIHsqfSDlj5blgLzlpLHotKXnmoTpu5jorqTlgLwNCiAqIEBwYXJhbSB7T2JqZWN0fSBwYXlsb2FkIHVzZXIge0Jvb2xlYW59IOaYr+WQpuWMuuWIhueUqOaItw0KICovCgpleHBvcnQgZnVuY3Rpb24gZGJHZXQoX3JlZjMpIHsKICB2YXIgX3JlZjMkZGJOYW1lID0gX3JlZjMuZGJOYW1lLAogICAgICBkYk5hbWUgPSBfcmVmMyRkYk5hbWUgPT09IHZvaWQgMCA/ICdkYXRhYmFzZScgOiBfcmVmMyRkYk5hbWUsCiAgICAgIF9yZWYzJHBhdGggPSBfcmVmMy5wYXRoLAogICAgICBwYXRoID0gX3JlZjMkcGF0aCA9PT0gdm9pZCAwID8gJycgOiBfcmVmMyRwYXRoLAogICAgICBfcmVmMyRkZWZhdWx0VmFsdWUgPSBfcmVmMy5kZWZhdWx0VmFsdWUsCiAgICAgIGRlZmF1bHRWYWx1ZSA9IF9yZWYzJGRlZmF1bHRWYWx1ZSA9PT0gdm9pZCAwID8gJycgOiBfcmVmMyRkZWZhdWx0VmFsdWUsCiAgICAgIF9yZWYzJHVzZXIgPSBfcmVmMy51c2VyLAogICAgICB1c2VyID0gX3JlZjMkdXNlciA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmMyR1c2VyOwogIHJldHVybiBjbG9uZURlZXAoZGIuZ2V0KHBhdGhJbml0KHsKICAgIGRiTmFtZTogZGJOYW1lLAogICAgcGF0aDogcGF0aCwKICAgIHVzZXI6IHVzZXIsCiAgICBkZWZhdWx0VmFsdWU6IGRlZmF1bHRWYWx1ZQogIH0pKS52YWx1ZSgpKTsKfQovKioNCiAqIEBkZXNjcmlwdGlvbiDojrflj5blrZjlgqjmlbDmja7lupPlr7nosaENCiAqIEBwYXJhbSB7T2JqZWN0fSBwYXlsb2FkIHVzZXIge0Jvb2xlYW59IOaYr+WQpuWMuuWIhueUqOaItw0KICovCgpleHBvcnQgZnVuY3Rpb24gZGF0YWJhc2UoKSB7CiAgdmFyIF9yZWY0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fSwKICAgICAgX3JlZjQkZGJOYW1lID0gX3JlZjQuZGJOYW1lLAogICAgICBkYk5hbWUgPSBfcmVmNCRkYk5hbWUgPT09IHZvaWQgMCA/ICdkYXRhYmFzZScgOiBfcmVmNCRkYk5hbWUsCiAgICAgIF9yZWY0JHBhdGggPSBfcmVmNC5wYXRoLAogICAgICBwYXRoID0gX3JlZjQkcGF0aCA9PT0gdm9pZCAwID8gJycgOiBfcmVmNCRwYXRoLAogICAgICBfcmVmNCR1c2VyID0gX3JlZjQudXNlciwKICAgICAgdXNlciA9IF9yZWY0JHVzZXIgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjQkdXNlciwKICAgICAgX3JlZjQkdmFsaWRhdG9yID0gX3JlZjQudmFsaWRhdG9yLAogICAgICB2YWxpZGF0b3IgPSBfcmVmNCR2YWxpZGF0b3IgPT09IHZvaWQgMCA/IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0cnVlOwogIH0gOiBfcmVmNCR2YWxpZGF0b3IsCiAgICAgIF9yZWY0JGRlZmF1bHRWYWx1ZSA9IF9yZWY0LmRlZmF1bHRWYWx1ZSwKICAgICAgZGVmYXVsdFZhbHVlID0gX3JlZjQkZGVmYXVsdFZhbHVlID09PSB2b2lkIDAgPyAnJyA6IF9yZWY0JGRlZmF1bHRWYWx1ZTsKCiAgcmV0dXJuIGRiLmdldChwYXRoSW5pdCh7CiAgICBkYk5hbWU6IGRiTmFtZSwKICAgIHBhdGg6IHBhdGgsCiAgICB1c2VyOiB1c2VyLAogICAgdmFsaWRhdG9yOiB2YWxpZGF0b3IsCiAgICBkZWZhdWx0VmFsdWU6IGRlZmF1bHRWYWx1ZQogIH0pKTsKfQ=="},{"version":3,"sources":["C:/Projekte/vue-admin/d2-admin-start-kit/src/libs/util.db.js"],"names":["low","LocalStorage","util","cloneDeep","adapter","process","env","VUE_APP_VERSION","db","defaults","sys","database","write","pathInit","dbName","path","user","validator","defaultValue","uuid","cookies","get","currentPath","value","undefined","set","dbSet","dbGet"],"mappings":"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","sourcesContent":["import low from 'lowdb'\r\nimport LocalStorage from 'lowdb/adapters/LocalStorage'\r\nimport util from '@/libs/util'\r\nimport { cloneDeep } from 'lodash'\r\n\r\nconst adapter = new LocalStorage(`d2admin-${process.env.VUE_APP_VERSION}`)\r\nconst db = low(adapter)\r\n\r\ndb\r\n  .defaults({\r\n    sys: {},\r\n    database: {}\r\n  })\r\n  .write()\r\n\r\nexport default db\r\n\r\n/**\r\n * @description 检查路径是否存在 不存在的话初始化\r\n * @param {Object} payload dbName {String} 数据库名称\r\n * @param {Object} payload path {String} 路径\r\n * @param {Object} payload user {Boolean} 区分用户\r\n * @param {Object} payload validator {Function} 数据校验钩子 返回 true 表示验证通过\r\n * @param {Object} payload defaultValue {*} 初始化默认值\r\n * @returns {String} 可以直接使用的路径\r\n */\r\nexport function pathInit ({\r\n  dbName = 'database',\r\n  path = '',\r\n  user = true,\r\n  validator = () => true,\r\n  defaultValue = ''\r\n}) {\r\n  const uuid = util.cookies.get('uuid') || 'ghost-uuid'\r\n  const currentPath = `${dbName}.${user ? `user.${uuid}` : 'public'}${path ? `.${path}` : ''}`\r\n  const value = db.get(currentPath).value()\r\n  if (!(value !== undefined && validator(value))) {\r\n    db\r\n      .set(currentPath, defaultValue)\r\n      .write()\r\n  }\r\n  return currentPath\r\n}\r\n\r\n/**\r\n * @description 将数据存储到指定位置 | 路径不存在会自动初始化\r\n * @description 效果类似于取值 dbName.path = value\r\n * @param {Object} payload dbName {String} 数据库名称\r\n * @param {Object} payload path {String} 存储路径\r\n * @param {Object} payload value {*} 需要存储的值\r\n * @param {Object} payload user {Boolean} 是否区分用户\r\n */\r\nexport function dbSet ({\r\n  dbName = 'database',\r\n  path = '',\r\n  value = '',\r\n  user = false\r\n}) {\r\n  db.set(pathInit({\r\n    dbName,\r\n    path,\r\n    user\r\n  }), value).write()\r\n}\r\n\r\n/**\r\n * @description 获取数据\r\n * @description 效果类似于取值 dbName.path || defaultValue\r\n * @param {Object} payload dbName {String} 数据库名称\r\n * @param {Object} payload path {String} 存储路径\r\n * @param {Object} payload defaultValue {*} 取值失败的默认值\r\n * @param {Object} payload user {Boolean} 是否区分用户\r\n */\r\nexport function dbGet ({\r\n  dbName = 'database',\r\n  path = '',\r\n  defaultValue = '',\r\n  user = false\r\n}) {\r\n  return cloneDeep(db.get(pathInit({\r\n    dbName,\r\n    path,\r\n    user,\r\n    defaultValue\r\n  })).value())\r\n}\r\n\r\n/**\r\n * @description 获取存储数据库对象\r\n * @param {Object} payload user {Boolean} 是否区分用户\r\n */\r\nexport function database ({\r\n  dbName = 'database',\r\n  path = '',\r\n  user = false,\r\n  validator = () => true,\r\n  defaultValue = ''\r\n} = {}) {\r\n  return db.get(pathInit({\r\n    dbName, path, user, validator, defaultValue\r\n  }))\r\n}\r\n"]}]}